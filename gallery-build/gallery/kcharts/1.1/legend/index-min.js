KISSY.add("gallery/kcharts/1.1/legend/index",function(e,k,j,g){function h(a){this._cfg=e.mix({themeCls:"ks-charts-legend",css:{},iconType:"rect",evtBind:!1},a);this.init()}var f=e.all,i=e.Event;e.augment(h,{init:function(){var a=this._cfg,b=a.chart,c=0;if(a.container&&(this.$ctn=f(a.container),!this.$ctn[0]))return;this._infos={};for(var d in b._datas.total)c+=1;e.log(b.color.getColors(0,c));e.mix(this._infos,{colors:b.color.getColors(0,c),series:b._cfg.series});this.render()},render:function(){var a=
this,b=a._cfg,c=b.chart,d=c._innerContainer;a._html="<div class="+b.themeCls+"><ul>";a.createIcon(b.iconType);a._html+="</ul></div>";f(a._html).appendTo(a.$ctn);a.$legend=f("."+b.themeCls,a.$ctn);a.renderIcon();a.$legend.css({marginLeft:d.width,marginTop:0}).css(b.css);b.evtBind&&c.on("afterRender",function(){a.bindEvt()});e.log(a)},renderIcon:function(){var a=this;"rect"!=a._cfg.iconType&&f(".legend-icon",a.$legend).each(function(b,c){var d=a._infos.colors[c].DEFAULT,e=j(this[0]);e.circle(5,5,3).attr({fill:d,
stroke:d});e.path("M0,5L10,5").attr({stroke:d,"stroke-width":2})})},createIcon:function(a){"rect"==a?this.createHtmlIcon():this.createCanvasIcon()},createCanvasIcon:function(){var a=this._cfg.chart,b=this._infos,c;for(c in a._datas.total)this._html+=g("<li class="+(!1==b.series[c].isShow?"clearfix disable":"clearfix")+"><div class='legend-icon'></div><div class='legend-text'>{{text}}</div></li>").render(b.series[c])},createHtmlIcon:function(){var a=this._cfg.chart,b=this._infos,c;for(c in a._datas.total)this._html+=
g("<li class="+(!1==b.series[c].isShow?"clearfix disable":"clearfix")+"><div class='legend-icon' style='background-color:"+b.colors[c].DEFAULT+"''></div><div class='legend-text'>{{text}}</div></li>").render(b.series[c])},destroy:function(){i.detach(f("li",_cfg.container),"click");this.$ctn.html("")},bindEvt:function(){var a=this._cfg.chart,b=a.chartType,c=this.$ctn;i.on(f("li",c),"click",function(d){var g=f(d.currentTarget).toggleClass("disable"),d=e.indexOf(d.currentTarget,f("li",c));g.hasClass("disable")?
("linechart"===b&&a.hideLine(d),"barchart"===b&&a.hideBar(d)):("linechart"===b&&a.showLine(d),"barchart"===b&&a.showBar(d))})}});return h},{requires:["gallery/kcharts/1.1/tools/htmlpaper/index","gallery/kcharts/1.1/raphael/index","gallery/template/1.0/index","./assets/legend.css"]});
