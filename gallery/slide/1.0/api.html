<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>KISSY gallery - yourGallery</title>

<link rel="stylesheet" href="http://a.tbcdn.cn/s/kissy/1.3.0/css/dpl/base-min.css"/>
<link rel="stylesheet" href="../../../tools/skin/default.css"/>
<script src="http://a.tbcdn.cn/s/kissy/1.3.0/seed.js" charset="utf-8"></script>
<script src="../../../tools/skin/show-code.js" charset="utf-8"></script>
<link rel="stylesheet" href="./assets/demo.css"/>
<style>
	.span9{width:auto !important;}
	pre {
		background-color: #F5F5F5;
		border: 1px solid rgba(0, 0, 0, 0.15);
		border-radius: 4px 4px 4px 4px;
		display: block;
		font-size: 13px;
		line-height: 20px;
		margin: 0 0 10px;
		padding: 9.5px;
		white-space: pre-wrap;
		word-break: break-all;
		word-wrap: break-word;
	}
	em {font-weight:bold;color:blue;}
	hr {
		size:1;color:gray;
	}
</style>
<script>
    KISSY.config({
        packages:[
            {
                name:"gallery",
                tag:"20111220",
                path:"../../../",  // cdn上适当修改对应路径
                charset:"utf-8"
            }
        ]
    });
</script>
</head>
<body>
<div id="header">
    <h1 class="logo"><a alt="KISSY" href="http://kissyui.com/"><img src="http://a.tbcdn.cn/s/kissy/logo.png"/></a></h1>
    <div class="sub-title">Gallery</div>
    <ul class="navigation">
        <li><a href="http://docs.kissyui.com/">首页</a></li>
        <li><a href="http://github.com/kissyteam">源码</a></li>
    </ul>

</div>
<div id="content">
    <div class="s-crumbs">
        <span>当前位置：</span>
        <a href="http://kissyui.com/">KISSY</a>
        <a href="../../../index.html">Gallery</a>
        <span>Slide</span>
    </div>

		<div class="span9">
			<h1>KISSY Slide 控件</h1>
			<hr class="smooth large" />

			<blockquote><p>这是一个选项卡切换控件，基于KISSY 1.3.0，并针对移动终端（ios/Android）有简单的性能优化，动画流畅，支持基础的触屏事件。Slide控件具有良好的可定制性，目前已经运行于淘宝网的很多角落。</p>

</blockquote>

<p><a href="d1.html">Demo1</a>
<a href="d2.html">Demo2</a>
<a href="d3.html">Demo3</a>
<a href="d4.html">Demo4</a>
<a href="d5.html">Demo5</a>
<a href="d6.html">Demo6</a>
<a href="d7.html">Demo7</a>
<a href="d8.html">Demo8</a>
<a href="touch.html">Touch</a></p>

<ul>
<li>Version 1.0</li>
<li>Author 拔赤</li>
<li>Update 2012-11-01</li>
</ul>


<h2>开始使用</h2>

<p>首先页面中引入kissy种子：</p>

<pre><code>&lt;script&gt;
    // 回调传入了S（KISSY对象）和Slide构造器
    KISSY.use('gallery/slide/1.0/',function(S,Slide){
        // 这里可以调用Slide
    });
&lt;/script&gt;
</code></pre>

<p>Slide依赖典型的HTML结构</p>

<pre><code>&lt;div id="J_tab" class="slide-style"&gt;
    &lt;ul class="tab-nav clearfix"&gt;&lt;!--选项卡导航，内容可以是空--&gt;
        &lt;!--若内容为空，则Slide会创建&lt;li&gt;&lt;/li&gt;--&gt;
        &lt;li class="selected"&gt;&lt;a href="#"&gt;1&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=""&gt;2&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=""&gt;3&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=""&gt;4&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
    &lt;div class="tab-content"&gt;&lt;!--选项卡内容的父容器--&gt;
        &lt;div class="tab-pannel"&gt;&lt;!--选项卡的每项的容器--&gt;
            &lt;!--第1个选项卡中的内容--&gt;
        &lt;/div&gt;
        &lt;!--一般情况下，需要指定默认情况非首帧是否显示--&gt;
        &lt;div class="tab-pannel hidden"&gt;
            &lt;!--第2个选项卡中的内容--&gt;
        &lt;/div&gt;
        &lt;div class="tab-pannel hidden"&gt;
            &lt;!--第3个选项卡中的内容--&gt;
        &lt;/div&gt;
        &lt;div class="tab-pannel hidden"&gt;
            &lt;!--第4个选项卡中的内容--&gt;
            &lt;textarea class="data-lazyload"&gt;
                延时加载的内容
            &lt;/textarea&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<ul>
<li><code>#J_tab</code>，Slide的ID，名称自取，必须指定，用作hook</li>
<li><code>ul.tab-nav</code>,控制导航,必须指定,容器内容可以为空，默认指定自然数为下标，名称可定制</li>
<li><code>ul.tab-nav li.selected</code>,控制tab页签,若有li，则必须指定，名称可定制</li>
<li><code>div.tab-content</code>，内容容器，必须指定，名称可定制</li>
<li><code>div.tab-content div.tab-pannel</code>，内容面板，必须指定，名称可定制</li>
</ul>


<p>其中，tab-content通常用来控制Slide视口宽高，定位需是<code>position:relative</code>。</p>

<p>这样来调用：</p>

<pre><code>KISSY.use('gallery/slide/1.0/',function(S,Slide){
    // 只能通过new来初始化，不支持包装器风格的初始化
    var s = new Slide('JSlide');
});
</code></pre>

<h2>Slide的样式</h2>

<p>如果是图片轮播，<code>div.tab-content</code>需要指定宽高，超出部分隐藏掉，<code>div.tab-pannel</code>的宽高都为100%即可，这里需要指定<code>div.tab-content</code>的<code>position:relative</code>。</p>

<p>普通tab点击切换（无特效），内容部分高度不定，若带滚动切换效果，<code>div.tab-content</code>尺寸可以随意，Slide会根据pannel的尺寸来初始化当前父容器的尺寸</p>

<p>基本结构包含导航和内容两部分，“向前”、“向后”的按钮切换由开发者添加</p>

<p>控制样式的className可以配置，需要在js中启动的时候做相应配置，在不配置的情况下，Slide以典型html结构做为默认配置进行渲染</p>

<h2>初始化</h2>

<p>通过构造函数的形式来渲染一个幻灯（Tab），第二个对象是配置参数，比如下面这两段代码，这段代码用来初始化一个简单的Tab</p>

<pre><code>new Slide('J_tab',{ // 直接指定id，而不是选择器
    eventype:'click' //通过点击页签来切换Tab
});
</code></pre>

<p>通过配置参数来定制渲染的示例代码：</p>

<pre><code>new Slide('J_tab',{
    eventype:'click',//tab上的触发事件
    effect:'vSlide',//切换效果为纵向滚动
    autoSlide:true,//自动播放
    timeout:2000,//切换时间间隔
    speed:500,//切换速度，越小越快，单位为毫秒
    hoverStop:true//鼠标经过内容是否停止播放
});
</code></pre>

<h2>跑马灯原理</h2>

<p>该Slide支持跑马灯效果，跑马灯是可以连续相同方向滚动的幻灯，帧首尾相连接。有两种实现方式，一种是滚动时将首（尾）的节点拷贝至尾（首），另一种是初始化时处理首尾的节点，滚动时只改变位置，出于性能的考虑，这里选用第二种方式。</p>

<p>由于窗口滑块所容纳的帧数可变，因此，需要同时复制多个帧至首位，数量根据Slide组件的colspan参数指定，比如，colspan参数默认为1，即滑块只容纳一个帧，首尾各复制一份。如果colspan为2，则滑块的跨度为2，复制两分，如图：</p>

<p><img src="http://img02.taobaocdn.com/tps/i2/T1xl62Xb0fXXXcUVob-597-199.png" alt="" /></p>

<p>切换幻灯的动作实际上是滑块移动的操作，滑块定位在初始位置由参数defaultTab指定，默认为0，如果colspan指定了跨度为2，则滑块初始位置为：</p>

<p><img src="http://img01.taobaocdn.com/tps/i1/T1Cj61XcJkXXXuXRQf-599-148.png" alt="" /></p>

<p>如果Slide不是跑马灯效果，则和基本的Tab切换原理一样，无须复制节点</p>

<hr class="smooth large" />


<h2>API</h2>

<p>Slide 构造器第一个参数为待渲染的容器，可以直接写ID，比如<code>J_Slide</code>，也可以写选择器，比如<code>#J_Slide</code>。还可以直接传Node节点。</p>

<p>Slide构造器第二个参数用以传入配置项，这些配置项为基础参数，Slide支持LayerSlide（多层动画），如果指定LayerSlide为true，需要了解SubLayer（帧里的子层）的配置参数</p>

<hr class="smooth" />


<h3>基本参数</h3>

<p><em>autoSlide</em> (Boolean)</p>

<p>是否自动播放，默认为false</p>

<p><em>speed</em> (Float)</p>

<p>帧切换的速度，默认为500(ms)</p>

<p><em>timeout</em> (Number)</p>

<p>帧切换的时间间隔，默认为1000(ms)</p>

<p><em>effect</em> (String)</p>

<p>帧切换类型，默认为'none',取值：</p>

<ul>
<li>none:无特效</li>
<li>fade:渐隐</li>
<li>hSlide:水平切换</li>
<li>vSlide:垂直切换</li>
</ul>


<p><em>eventType</em> (String)</p>

<p>触发tab切换的nav上的事件类型，默认为'click'，推荐使用：</p>

<ul>
<li>click:点击</li>
<li>mouseover:鼠标经过(这个可能会多次触发切换事件,不推荐)</li>
<li>mouseenter:鼠标进入</li>
</ul>


<p><em>easing</em> (String)</p>

<p>帧切换的缓动值，默认为'easeBoth'，取值请参照<a href="http://docs.kissyui.com/docs/html/api/core/anim/index.html">KISSY.Anim</a></p>

<p><em>hoverStop</em> (Boolean)</p>

<p>鼠标悬停在面板上是否停止自动播放，默认为true</p>

<p><em>selectedClass</em> (String)</p>

<p>导航选中时的className，默认为'selected'</p>

<p><em>conClass</em> (String)</p>

<p>整个Tab容器的className，可不传</p>

<p><em>navClass</em> (String)</p>

<p>导航容器的className，默认为tab-nav</p>

<p><em>triggerSelector</em> (String)</p>

<p>导航中的选项所在的选择器，即触碰元素的选择器，默认为li，如果为<code>&lt;li&gt;&lt;a&gt;&lt;/a&gt;&lt;/li&gt;</code>，可以写为<code>li a</code></p>

<p><em>contentClass</em> (String)</p>

<p>Pannel父容器的ClassName，即Tab内容容器的className,默认为tab-content</p>

<p><em>pannelClass</em> (String)</p>

<p>tab面板的className，默认为tab-pannel</p>

<p><em>id</em> (String)</p>

<p>整个Tab组件所在的容器id，通常是通过Slide构造器的第一个参数指定，这里可不传，应当直接写id，比如"id"（正确），"#id" （不正确）</p>

<p><em>carousel</em> (Boolean)</p>

<p>是否以跑马灯形式播放，默认为false</p>

<p><em>touchmove</em> (Boolean)</p>

<p>是否支持Slide跟随手指滑而滑动，默认为false。</p>

<p><em>adaptive<code>_</code>fixed<code>_</code>width</em> (Boolean)</p>

<p>屏幕是否根据控件的宽度改变重新渲染尺寸，默认为false，主要在组件定宽高的场景中，保证resize时tab-pannel尺寸正确</p>

<p><em>adaptive<code>_</code>fixed<code>_</code>height</em> (boolean)</p>

<p>屏幕是否根据控件的高度改变重新渲染尺寸，默认为false,主要在组件定宽高的场景中，保证resize时tab-pannel尺寸正确</p>

<p><em>adaptive<code>_</code>fixed<code>_</code>size</em> (boolean)</p>

<p>屏幕是否根据控件的宽度和高度改变重新渲染尺寸，默认为false,主要在组件定宽高的场景中，保证resize时tab-pannel尺寸正确</p>

<p><em>defaultTab</em> (Number)</p>

<p>默认定位在某个帧，默认为0，即第一帧</p>

<p><em>layerSlide</em> (Boolean)</p>

<p>是否开启分层动画，默认为false（在IE6/7/8里始终关闭layerSlide）</p>

<p><em>layerClass</em> (String)</p>

<p>subLayer的className，默认值为tab-animlayer，未实现，默认用alt="sublayer"来标识</p>

<p><em>reverse</em> (boolean)</p>

<p>"播放下一个"和"播放上一个"对调，默认为false</p>

<p><em>adaptive<code>_</code>height</em> (function)</p>

<p>同下</p>

<p><em>adaptive<code>_</code>width</em> (function)</p>

<p>如果是百分比设置容器的宽度的话，需要指定这个函数，返回一个宽度值，动态的得到可变化的宽度,默认为false，代码示例:</p>

<pre><code>var slide = new Slide('J_tab',{
    adaptive_width:function(){
        return document.body.offsetWidth;
    }
});
</code></pre>

<p><em>colspan</em> (Number)</p>

<p>滑块窗口的跨度，比如滑块中包含2帧，则指定为2</p>

<p><em>webkitOptimize</em> (Boolean)</p>

<p>是否在webkit浏览器中开启硬件加速，默认为true，因为webkit在各平台中可能有bug，常需要临时性关闭移动设备中的硬件加速，则可以通过设置此属性为false来实现。</p>

<p><em>animWrapperAutoHeightSetting</em> (Boolean)</p>

<p>beforeSwitch的时候是否修改animcon的宽高，默认为true，当slide的内容尺寸（高度）大都固定时，建议此属性设置为true，如果slide内容尺寸不固定，建议设置为false</p>

<hr class="smooth" />


<h3>事件</h3>

<p><em>ready</em></p>

<p>初始化完成后的事件回调，带入上下文this，带入参数为</p>

<pre><code>{
    index:index,        // 当前帧的索引
    navnode:navnode,    // 当前导航的节点
    pannelnode:pannelnode//当前面板的节点
}
</code></pre>

<p><em>switch</em></p>

<p>切换发生时的事件，特指切换动作必然发生时的时刻，回调上下文和参数同上</p>

<p><em>beforeSwitch</em></p>

<p>“切换至”的事件，回调返回false可以阻止切换事件的发生</p>

<p><em>beforeTailSwitch</em></p>

<p>从某一帧的角度看，这一帧切换到下一帧之前发生的事件,参数同上</p>

<p><em>afterSwitch</em></p>

<p>切换完成的动作</p>

<blockquote><p>如果当Slide为跑马灯，且colspan大于1，则回调函数中的index值的取值可能会有偏差，原则上不推荐这种模式下获取当前帧的index</p></blockquote>

<hr class="smooth" />


<h3>方法</h3>

<p><em>init</em></p>

<p>初始化，参数为一个对象，带入配置项</p>

<p><em>previous(callback)</em></p>

<p>切换到上一个，可以传入callback，执行切换完毕后的回调</p>

<p><em>next(callback)</em></p>

<p>切换到下一个，可以传入callback，执行切换完毕后的回调</p>

<p><em>go(index,callback)</em></p>

<p>跳转到指定索引的帧，参数为index:0,1,2,3...，callback为切换完毕后的回调</p>

<p><em>add(node,index)</em></p>

<p>添加一个帧，node为待添加的节点，可以是node，也可以是字符串。index为加入的节点的位置，默认为最后一个</p>

<p><em>remove(index)</em></p>

<p>删除一个帧，传入要删除的帧的index</p>

<p><em>removeLast</em></p>

<p>删除最后一个帧，无参数，当只有一帧时无法删除这一帧</p>

<p><em>play</em></p>

<p>开始自动播放</p>

<p><em>stop</em></p>

<p>停止自动播放</p>

<p><em>hightlightNav</em></p>

<p>高亮某个特定的导航项，参数为索引值index:0,1,2,3...</p>

<p><em>is<code>_</code>first</em></p>

<p>是否当前停止在第一帧</p>

<p><em>is<code>_</code>last</em></p>

<p>是否当前停止在最后一真</p>

<p><em>resetSlideSize</em></p>

<p>可以传入一个索引值为参数，重置第index个Slide的宽度和高度,幻灯尺寸发生动态变化时，需要调用这个方法来重设宽高，内部方法</p>

<p><em>relocateCurrentTab</em></p>

<p>无参数，重新修正当前帧的位置，内部方法</p>

<p><em>addHeightTimmer</em></p>

<p>无参数，添加监听内容高度的监听器，设置外包裹容器的高度，当内容高度不确定时，可能会用到此函数</p>

<p><em>removeHeightTimmer</em></p>

<p>无参数，和上一个函数对应，接触监听器</p>

<p><em>initLayer</em></p>

<p>初始化SubLayer，无参数，（目前触屏模式下默认关闭）</p>


		</div>
	</div>

</body>
</html>
